{
  "openapi": "3.0.0",
  "info": {
    "title": "Finance-app",
    "description": "Its API for web aplication Finance-app",
    "version": "2.2.2"
  },
  "servers": [
    {
      "url": "https://localhost:4000/api"
    }
  ],
  "tags": [
    {
      "name": "Auth",
      "description": "Authorization endpoints"
    },
    {
      "name": "Dynamic",
      "description": "Dynamic endpoints"
    },
    {
      "name": "Transaction",
      "description": "Transaction endpoints"
    }
  ],
  "paths": {
    "/auth/register": {
      "post": {
        "tags": ["Auth"],
        "summary": "Create new user.",
        "requestBody": {
          "content": {
            "aplication/json": {
              "schema": {
                "$ref": "#/components/schemas/NewUserRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NewUserResponse"
                }
              }
            }
          },
          "400": {
            "description": "Bad request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BadRequest"
                }
              }
            }
          },
          "409": {
            "description": "Conflict",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BadRequest"
                },
                "example": {
                  "message": "Email in use"
                }
              }
            }
          }
        }
      }
    },
    "/auth/login": {
      "post": {
        "tags": ["Auth"],
        "summary": "LogIn user",
        "requestBody": {
          "content": {
            "aplication/json": {
              "schema": {
                "$ref": "#/components/schemas/LoginUserRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NewUserResponse"
                }
              }
            }
          },
          "500": {
            "description": "User not found or all need to send all fields ",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BadRequest"
                }
              }
            }
          }
        }
      }
    },
    "/auth/current": {
      "get": {
        "tags": ["Auth"],
        "summary": "Get current user",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CurrentUserResponse"
                }
              }
            }
          },
          "401": {
            "description": "Conflict",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BadRequest"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/auth/logout": {
      "post": {
        "tags": ["Auth"],
        "summary": "Logout current user",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "aplication/json": {
                "schema": {
                  "$ref": "#components/schemas/LogoutResponse"
                },
                "example": {
                  "message": "Logout success"
                }
              }
            }
          },
          "401": {
            "description": "Not authorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BadRequest"
                },
                "example": {
                  "message": "Not authorized"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/auth/balance": {
      "patch": {
        "tags": ["Auth"],
        "summary": "Update balance",
        "requestBody": {
          "content": {
            "aplication/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateBalance"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UpdateBalance"
                }
              }
            }
          },
          "401": {
            "description": "Not authorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BadRequest"
                }
              }
            }
          },
          "500": {
            "description": "Conflict",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BadRequest"
                },
                "example": {
                  "message": "balance is required"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/dynamic/chart": {
      "get": {
        "tags": ["Dynamic"],
        "summary": "Get information about customers savings for chart",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetChart"
                }
              }
            }
          },
          "401": {
            "description": "Not authorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BadRequest"
                }
              }
            }
          },
          "404": {
            "description": "Conflict",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BadRequest"
                },
                "example": {
                  "message": "Not Found!"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/dynamic/statistic": {
      "get": {
        "tags": ["Dynamic"],
        "summary": "Get information about customers savings per month for statistic",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetStatistic"
                }
              }
            }
          },
          "401": {
            "description": "Not authorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BadRequest"
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BadRequest"
                },
                "example": {
                  "message": "Not Found!"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/dynamic/flatImage": {
      "patch": {
        "tags": ["Dynamic"],
        "summary": "Add or change image of flat",
        "requestBody": {
          "content": {
            "multipart/form-data": {
              "schema": {
                "$ref": "#/components/schemas/UploadImageRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UploadImageResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BadRequest"
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BadRequest"
                },
                "example": {
                  "message": "Not Found!"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/category": {
      "get": {
        "tags": ["Transaction"],
        "summary": "Obtaining a list of categories for which creation of transaction records is available.",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetListCategories"
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ServiceUnavailable"
                }
              }
            }
          },
          "503": {
            "description": "Service Unavailable",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ServiceUnavailable"
                }
              }
            }
          }
        }
      }
    },
    "/dayLimit": {
      "get": {
        "tags": ["Transaction"],
        "summary": "Daily and monthly spending limit.",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetSpendingLimit"
                }
              }
            }
          },
          "401": {
            "description": "Not authorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BadRequest"
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BadRequest"
                },
                "example": {
                  "message": "Not Found!"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/transaction": {
      "post": {
        "tags": ["Transaction"],
        "summary": "Request to add a transaction",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PostTransactionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Transaction information.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PostTransactionResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BadRequest"
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BadRequest"
                },
                "example": {
                  "message": "Not Found!"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/transaction/:transactionId": {
      "patch": {
        "tags": ["Transaction"],
        "summary": "Request to change the information of the added transaction.",
        "parameters": [
          {
            "in": "path",
            "name": "transactionId",
            "required": true,
            "type": "string",
            "description": "Transaction id"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PostTransactionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Transaction information.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PostTransactionResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BadRequest"
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BadRequest"
                },
                "example": {
                  "message": "Not Found!"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "delete": {
        "tags": ["Transaction"],
        "summary": "Deleting a transaction.",
        "parameters": [
          {
            "in": "path",
            "name": "transactionId",
            "required": true,
            "type": "string",
            "description": "Transaction id"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DeleteTransaction"
                }
              }
            }
          },
          "401": {
            "description": "Not authorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BadRequest"
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BadRequest"
                },
                "example": {
                  "message": "Not Found!"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    }
  },
  "components": {
    "schemas": {
      "BadRequest": {
        "type": "object",
        "properties": {
          "message": {
            "type": "string",
            "example": "User not found"
          }
        },
        "description": "Bad Request"
      },
      "InternalServerError": {
        "type": "object",
        "properties": {
          "message": {
            "type": "string",
            "example": "Internal Server Error..."
          }
        },
        "description": "Internal Server Error"
      },
      "ServiceUnavailable": {
        "type": "object",
        "properties": {
          "message": {
            "type": "string",
            "example": "Service Unavailable..."
          }
        },
        "description": "Service Unavailable"
      },
      "NewUserRequest": {
        "required": ["email", "name", "password"],
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "User's name only words without numbers and symbols",
            "example": "Entony"
          },
          "email": {
            "type": "string",
            "description": "User's email",
            "format": "email",
            "example": "entonymail@gmail.com"
          },
          "password": {
            "type": "string",
            "description": "User's password length: min 6 max:infinity",
            "format": "password",
            "example": "qwerty12345"
          }
        },
        "description": "New user registration requeest body"
      },
      "LoginUserRequest": {
        "required": ["email", "password"],
        "type": "object",
        "properties": {
          "email": {
            "type": "string",
            "description": "User's email",
            "format": "email",
            "example": "entonymail@gmail.com"
          },
          "password": {
            "type": "string",
            "description": "User's password length: min 7 max:32",
            "format": "password",
            "example": "qwerty12345"
          }
        },
        "description": "User logIn requeest body"
      },
      "NewUserResponse": {
        "type": "object",
        "properties": {
          "token": {
            "type": "string",
            "description": "User's token after login",
            "format": "jwt",
            "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY0MWIwYjM5ZmZkNDAzOWMyNjljNGI1OSIsImlhdCI6MTY3OTQ5NDczOCwiZXhwIjoxNjc5NTgxMTM4fQ.Wv0c7Snp7BU8vlziJ6sV0CzUHOs1bPUqnTK8LZJSqjI"
          },
          "name": {
            "type": "string",
            "description": "User's name only words without numbers and symbols",
            "example": "Entony"
          },
          "email": {
            "type": "string",
            "description": "User's email with pattern '/^[a-z0-9]+@[a-z]+\n\\.[a-z]{2,3}/'",
            "example": "entonymail@gmail.com"
          },
          "balance": {
            "type": "number",
            "description": "User's initial balance or updated",
            "format": ""
          }
        },
        "description": "User requeest body"
      },
      "CurrentUserResponse": {
        "type": "object",
        "properties": {
          "user": {
            "type": "object",
            "description": "User`s data",
            "properties": {
              "_id": {
                "type": "string",
                "example": "641b0b39ffd4039c269c4b59"
              },
              "name": {
                "type": "string",
                "example": "Entony"
              },
              "password": {
                "type": "string",
                "example": "qwerty12345"
              },
              "email": {
                "type": "string",
                "example": "entonymail@gmail.com"
              },
              "balance": {
                "type": "number",
                "example": "1200"
              },
              "token": {
                "type": "string",
                "format": "jwt",
                "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY0MWIwYjM5ZmZkNDAzOWMyNjljNGI1OSIsImlhdCI6MTY3OTQ5NjUzNSwiZXhwIjoxNjc5NTgyOTM1fQ.LrXKRdNnjMFf2kKUxry3b7I0zQ8KUelaOgJpU6XpLXo"
              },
              "verify": {
                "type": "boolean",
                "example": false
              },
              "verificationToken": {
                "type": "string",
                "example": "HhOe8ZMLLgmAM5MA3Lxq9"
              },
              "createdAt": {
                "type": "string",
                "example": "2023-01-01T14:05:45.533Z"
              },
              "updatedAt": {
                "type": "string",
                "example": "2023-03-22T20:10:55.449Z"
              }
            }
          }
        },
        "description": "Current user requeest body"
      },
      "LogoutResponse": {
        "type": "object",
        "properties": {
          "message": {
            "type": "string",
            "example": "Logout success"
          },
          "description": "Success"
        }
      },
      "UpdateBalance": {
        "type": "object",
        "properties": {
          "balance": {
            "type": "number",
            "example": 2100
          }
        },
        "description": "Success"
      },
      "GetChart": {
        "type": "object",
        "properties": {
          "lastYearInfo": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "month": {
                  "type": "string",
                  "example": "January"
                },
                "expenses": {
                  "type": "number",
                  "example": 2100
                },
                "incomes": {
                  "type": "number",
                  "example": 2100
                },
                "acumulated": {
                  "type": "number",
                  "example": 2100
                }
              }
            }
          },
          "timeIsLeft": {
            "type": "object",
            "properties": {
              "year": {
                "type": "number",
                "example": 2
              },
              "month": {
                "type": "number",
                "example": 12
              }
            }
          },
          "acumulatedAsPercentage": {
            "type": "number",
            "example": 28
          },
          "acumulatedMoney": {
            "type": "number",
            "example": 2100
          },
          "acumulatedSqMeters": {
            "type": "number",
            "example": 28
          },
          "leftAcumulatedMoneyToMeter": {
            "type": "number",
            "example": 2000
          }
        },
        "description": "Success"
      },
      "GetStatistic": {
        "type": "object",
        "properties": {
          "incomeSumPerSelectedMonth": {
            "type": "number",
            "example": 28000
          },
          "expenseSumPerSelectedMonth": {
            "type": "number",
            "example": 21000
          },
          "acumulatedSumPerSelectedMonth": {
            "type": "number",
            "example": 7000
          },
          "planMoneyPerMonth": {
            "type": "number",
            "example": 10000
          },
          "percentagePlanPerMonth": {
            "type": "number",
            "example": 20
          }
        },
        "description": "Success"
      },
      "PostTransactionRequest": {
        "required": ["sum", "categoryType"],
        "type": "object",
        "properties": {
          "sum": {
            "type": "number",
            "description": "Transaction amount",
            "example": 500
          },
          "categoryType": {
            "type": "string",
            "description": "Specify the type depending on the transaction type.",
            "example": "categoryType:expense or categoryType:income"
          },
          "comment": {
            "type": "string",
            "description": "Description of the cost type. It is indicated only when the transaction is for the expenditure of funds.",
            "example": "comment:coffee"
          }
        },
        "description": "The body of the transaction request."
      },
      "PostTransactionResponse": {
        "required": ["sum", "categoryType"],
        "type": "object",
        "properties": {
          "date": {
            "type": "date",
            "description": "Transaction date.",
            "example": "2023-03-25T19:53:06.444Z"
          },
          "comment": {
            "type": "string",
            "description": "Description of the cost type. It is indicated only when the transaction is for the expenditure of funds.",
            "example": "comment:coffee"
          },
          "sum": {
            "type": "number",
            "description": "Transaction amount.",
            "example": 500
          },
          "categoryType": {
            "type": "string",
            "description": "Selected transaction.",
            "example": "categoryType:expense or categoryType:income"
          },
          "category": {
            "type": "string",
            "description": "Cost category.",
            "example": "'other', 'Products', 'Clothing and footwear'..."
          },
          "owner": {
            "type": "string",
            "description": "id user.",
            "example": "641b000f26f8a8424c229c5f"
          },
          "_id": {
            "type": "string",
            "description": "id transaction.",
            "example": "641b000f26f8a84285729c5f"
          }
        },
        "description": "The body of complete information about the transaction."
      },
      "GetSpendingLimit": {
        "type": "object",
        "properties": {
          "limitDay": {
            "type": "number",
            "example": 548.39
          },
          "limitMonth": {
            "type": "number",
            "example": 17000.0
          }
        },
        "description": "Success"
      },
      "GetListCategories": {
        "type": "array",
        "items": {
          "type": "string",
          "example": "'Products', 'Clothing and footwear', 'Cafes and restaurants', 'Beauty and medicine', 'Health', 'Transport', 'House, Other'"
        },
        "description": "Success"
      },
      "DeleteTransaction": {
        "type": "object",
        "properties": {
          "message": {
            "type": "string",
            "example": "contact deleted"
          }
        }
      },
      "UploadImageRequest": {
        "type": "string",
        "format": "binary",
        "description": "Flat image"
      },
      "UploadImageResponse": {
        "type": "object",
        "properties": {
          "imageURL": {
            "type": "string",
            "example": "http://res.cloudinary.com/scfsdcsd/image/upload/vsgfdfgds/sfcsdcfs.png"
          }
        }
      }
    },
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    }
  }
}
